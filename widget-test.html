<!DOCTYPE html>
<html>
  <head>
    <title>Colibri Identity Widget Test</title>
  </head>
  <body>
    <h1>Colibri Identity Widget - Local Test</h1>
    
    <!-- Widget with custom callback URL -->
    <keycloak-widget
      id="auth"
      environment="development"
      subsidiary="allied"
      redirectUrl="/"
      callbackUrl="http://127.0.0.1:5500/widget-test.html"
    >
    </keycloak-widget>

    <link rel="stylesheet" href="./dist/login-widget.css" />
    <script src="./dist/keycloak-widget.umd.js"></script>
    
    <script>
      // Listen for redirect event from the widget
      document.getElementById("auth")
        .addEventListener("redirect", function(e) {
          console.log("Redirect event received:", e.detail.url);
          console.log("User session:", e.detail.userSession);
          
          // User session is already saved in sessionStorage with key "user_session"
          // You can also access it from the event
          const userSession = e.detail.userSession;
          
          alert('Authentication successful! Check console for user session.');
          
          // Handle the redirect in your application
          window.location.href = "http://127.0.0.1:5500/widget-test.html";
        });
    </script>
  </body>
</html>